# 纯文本的力量
<!-- 2020.03.20 -->

作为务实的程序员，我们的基础材料不是木头或铁，而是知识。我们收集需求作为知识，然后在设计、实现、测试和文档中表达这些知识。我们相信，保存知识的最佳格式是纯文本。有了纯文本，我们就可以使用我们可以使用的几乎所有工具，手动和编程地操作知识。

大多数二进制格式的问题在于理解数据所需的上下文与数据本身是分离的。您是在人为地将数据与其含义分离。数据也可能被加密；如果没有应用程序逻辑来解析它，它就毫无意义。但是，使用纯文本，您可以实现独立于创建它的应用程序的自描述数据流。

## 什么是纯文本

纯文本 是由可打印字符组成的，其形式是传递信息的。它可以像购物单一样简单：

- 牛奶
- 生菜
- 咖啡

或者像这本书的来源一样复杂（是的，它是纯文本的，这让出版商非常懊恼，他们希望我们使用文字处理器）。

信息部分很重要。以下文字不是有用的纯文本：

    hlj;uijn bfjxrrctvh jkni'pio6p7gu;vh bjxrdi5rgvhj

这种也不是：

    Field19=467abe

读者不知道 467abe 的意义可能是什么。我们希望我们的纯文本能够被人类理解。

---
## 提示 25 以纯文本形式保留知识
---

## 文本的力量

纯文本并不意味着文本是非结构化的； HTML，JSON，YAML等都是纯文本。 网络上的大多数基本协议也是如此，例如HTTP，SMTP，IMAP等。 这是有一些很好的理由的。

- 避免过时的保险
- 利用现有工具
- 轻松测试

## 避免过时的保险

易于理解的数据形式和自我描述的数据将超过所有其他形式的数据以及创建它们的应用程序。 期。 只要数据仍然存在，您就有机会使用它-可能在写入它的原始应用程序失效之后很长时间了。

您可以仅部分了解其格式来解析此类文件。 对于大多数二进制文件，您必须知道整个格式的所有详细信息才能成功解析它。

考虑一个给定的旧系统中的数据文件。[24] 您对原始应用程序了解甚少； 对您而言重要的是，它维护了一个客户的社会保险号列表，您需要查找并提取该列表。 在数据中，您会看到

      <FIELD10>123-45-6789</FIELD10>
      ...
      <FIELD10>567-89-0123</FIELD10>
      ...
      <FIELD10>901-23-4567</FIELD10>

认识到社会安全号码的格式，您可以快速编写一个小程序来提取该数据，即使您对文件中的其他任何信息都没有。

但是想象一下，如果文件是这样格式化的：

      AC27123456789B11P
      ...
      XY43567890123QTYL
      ...
      6T2190123456788AM

您可能不太容易意识到数字的重要性。 这是人类可读性与人类可理解性之间的区别。

在此过程中，FIELD10 也无济于事。 就像是

      <SSNO>123-45-6789</SSNO>

使练习变得轻而易举-并确保数据将比创建它的任何项目都有效。

## 杠杆作用

实际上，从版本控制系统到编辑器再到命令行工具，计算世界中的每个工具都可以在纯文本上运行。

---

### Unix 哲学
Unix 以围绕小型精巧工具的理念而设计而闻名，每种工具都旨在做好一件事情。 通过使用通用的基础格式（面向行的纯文本文件）可以启用此原理。 用于系统管理（用户和密码，网络配置等）的数据库都保留为纯文本文件。 （作为性能优化，某些系统还维护某些数据库的二进制形式。纯文本版本保留为二进制版本的接口。）

当系统崩溃时，您可能只需要一个最小的环境即可还原它（例如，您可能无法访问图形驱动程序）。 诸如此类的情况确实可以使您欣赏纯文本的简单性。

---

例如，假设您具有大型应用程序的生产部署，该应用程序具有复杂的特定于站点的配置文件。 如果该文件为纯文本格式，则可以将其放在版本控制系统下（请参阅话题 19 [_版本控制_](./版本控制.md) ），以便自动保留所有更改的历史记录。 文件比较工具（例如 diff 和 fc)使您可以一目了然地查看所做的更改，而 sum 则允许您生成校验和以监视文件的意外（或恶意）修改。

## 更易测试

如果使用纯文本创建综合数据来驱动系统测试，那么添加，更新或修改测试数据而无需创建任何特殊工具就很简单。 同样，可以使用 Shell 命令或简单脚本对回归测试的纯文本输出进行简单分析。

## 最低公分母

即使在基于区块链的智能代理的未来，它们可以自主地在荒芜而危险的互联网上旅行，在它们之间协商数据交换，无处不在的文本文件仍然会存在。事实上，在异构环境中，纯文本的优势可以超过所有的缺点。您需要确保所有各方都可以使用通用标准进行通信。纯文本就是这个标准。

## 相关内容包括

- 话题 32 [_配置_](../Chapter5/配置.md)
- 话题 17 [_Shell 游戏_](./shell.md)
- 话题 21 [_文本处理_](./文本处理.md)

## 挑战

- 使用您选择的语言中的简单二进制表示形式，设计一个小的通讯录数据库（名称，电话号码等）。 在阅读本挑战的其余部分之前，请执行此操作。
  - 使用 XML 将该格式转换为纯文本格式。
  - 对于每个版本，请添加一个新的长度可变的字段，称为“方向”，您可以在其中输入指向每个人房屋的方向。

关于版本和可扩展性会出现什么问题？ 哪种形式更容易修改？ 如何转换现有数据？
